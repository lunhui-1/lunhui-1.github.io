# MC指令辅助工具 - 更新说明

## 🚀 超级更新：主题卡密系统 (v1.17.9 beta版 - 2026年2月10日)

### 重磅功能：主题卡密系统
引入卡密验证机制，主题分为**免费基础主题**和**高级付费主题**！

#### 卡密系统特性
- 🔐 **16位随机卡密**：格式 `XXXX-XXXX-XXXX-XXXX`，包含大写字母和数字
- 📋 **有效期管理**：支持 7天/30天/90天/1年/永久 五种有效期
- 📝 **状态追踪**：记录卡密使用状态和使用时间
- 💾 **导出功能**：支持导出卡密列表到文本文件
- 🎨 **一键解锁**：输入卡密解锁所有14个高级动态主题

#### 卡密生成器使用
1. 打开 `卡密生成器.html` 文件（特殊部分，仅开发者使用）
2. 设置生成数量和有效期
3. 点击"生成卡密"按钮
4. 复制或导出卡密列表

---

### 全新重做的主题系统
彻底重构主题系统，引入专业图形库制作精致动态背景！

#### 新增第三方库（主题专用）

| 库名 | 版本 | 功能说明 |
|------|------|---------|
| **Vanta.js** | latest | 3D动态背景，星云/波纹效果 |
| **Three.js** | r128 | 3D星河系统漂流场景 |
| **tsParticles** | 3.3.0 | 高级粒子系统，粒子风暴效果 |
| **Pts.js** | 0.11.6 | 创意编程，几何三角网格 |
| **Granim.js** | 2.0.0 | 流动渐变背景 |
| **Babylon.js** | 6.37.1 | 3D分形树/场景渲染 |

#### 全新 24 个精致主题

**🔹 基础主题（免费 - 8个）**
| 主题 | 图标 | 描述 |
|------|------|------|
| 暗黑主题 | 🌙 | 经典暗色背景 |
| 亮色主题 | ☀️ | 清新明亮界面 |
| 海洋之歌 | 🌊 | 深海蓝色渐变 |
| 下界烈焰 | 🔥 | 岩浆火焰风格 |
| 翠绿森林 | 🌳 | 生机勃勃绿意 |
| 末地之境 | 🧩 | 神秘紫色星空 |
| 沙漠之境 | 🌵 | 热情沙漠风情 |
| 冰雪世界 | 🧊 | 冰清雪白风格 |

**🔹 高级主题（需卡密 - 14个）**

| 主题 | 技术 | 效果描述 |
|------|------|---------|
| 💫 虚空星云 | Vanta.js NET | 3D网状星云，鼠标交互 |
| 🌊 深海波纹 | Vanta.js WAVES | 流体波纹浮动 |
| 💎 星辰点阵 | Vanta.js DOTS | 点阵网格布局 |
| ☁️ 流云飘缕 | Vanta.js CLOUDS | 3D云层漂移 |
| 🐦 翔鸟天空 | Vanta.js BIRDS | 飞鸟群飞翔动画 |
| 💎 魔法圆环 | Vanta.js RINGS | 旋转圆环效果 |
| 💻 赛博世界 | Canvas API | 霓虹网格动画 |
| 🌻 北极极光 | Canvas API | 流动极光渐变 |
| 👓 矩阵代码 | Canvas API | 黑客帝国代码雨 |
| 🌐 几何网格 | Pts.js + Delaunator | 动态三角网格 |
| 🌌 宇宙星河 | Three.js | 3D星河旋转 |
| ✨ 粒子风暴 | tsParticles | 高级粒子连线 |
| 🌈 幻彩渐变 | Granim.js | 流动渐变背景 |

#### 主题选择器UI优化
- ✅ **二级菜单**：基础主题和高级主题分离显示
- ✅ **锁定状态**：未解锁的高级主题显示锁图标和遮罩
- ✅ **解锁入口**：设置界面提供快捷卡密输入入口
- ✅ **解锁状态提示**：解锁后显示已解锁状态标识

#### 主题特性
- ✅ 实时切换，无需刷新页面
- ✅ 鼠标/触控交互响应
- ✅ 自适应分辨率
- ✅ 智能资源管理（切换时自动释放旧资源）
- ✅ 卡密验证机制
- ✅ 移动端支持分类切换

---

### 其他新增第三方库
| 库名 | 版本 | 功能说明 |
|------|------|---------|
| **Day.js** | 1.11.10 | 轻量级日期处理库，本地化支持中文 |
| **Atropos** | 2.0.2 | 3D悬停效果库，为卡片添加立体感 |
| **Favico.js** | 0.3.10 | 动态favicon，可显示收藏数量徽标 |
| **hotkeys-js** | 3.13.3 | 键盘快捷键库，支持常用快捷操作 |

### 快捷键支持
新增键盘快捷键功能（按 `Ctrl + /` 查看帮助）：
- `Ctrl + K` - 聚焦搜索框
- `Ctrl + D` - 切换收藏面板
- `Ctrl + /` - 显示快捷键帮助
- `Ctrl + 1-5` - 快速切换分类（全部/常用/Java/基岩/网易）
- `ESC` - 关闭弹窗/侧边栏

### Favicon 徽标
- 收藏命令时，浏览器标签页图标会显示收藏数量徽标
- 动态弹出动画效果

### 版本号更新
- **版本号更新** - 从 `v1.16.9` 更新为 `v1.17.9 beta`

---

## ✨ 新增功能：F12开发者工具反馈 (v1.17.9 beta版 - 2026年2月10日)

### F12开发者工具提示
- 按 **F12**或**Ctrl+Shift+I** 打开开发者工具时显示欢迎信息
- 包含版本信息、当前主题、Bug反馈链接
- 提供开发者工具命令提示
  - `showToast(msg)` - 显示通知消息
  - `setTheme(name)` - 切换主题
  - `appState` - 应用状态对象
  - `data` - 数据对象
  - `KEY_SYSTEM` - 卡密系统配置

### 提示效果
```
⚡ MC指令辅助 v1.17.9 beta
伦回道尘制作 | 感谢使用！

🎮 当前已加载主题: dark
🔧 提交Bug反馈: https://github.com/...
📝 功能建议: 请在GitHub Issues中提交

📚 开发者工具命令:
  - showToast(msg)     显示通知消息
  - setTheme(name)     切换主题
  ...
```

---

## 🐛 修复的问题 (v1.17.9 beta版 - 2026年2月10日)

### 语法修复
- **修复onclick属性引号嵌套问题** - 第2980行，将嵌套模板字符串改为字符串拼接
- **修复onmouseover属性引号问题** - 第2986行，简化引号嵌套层次

### 库加载问题修复
- **修复库加载检测机制** - 为 `skinview3d`、`nbtify`、`cursor-effects` 等库添加延迟加载检测
- **添加库加载重试机制** - 最多重试5次，间隔500ms
- **添加初始化保护** - 防止库重复初始化
- **改进库加载日志** - 在控制台输出详细的加载状态信息
- **支持多个全局变量名** - 检查库时尝试多个可能的全局变量名（如 `skinview3d` 或 `SkinView3D`）
- **添加调试命令** - F12控制台新增 `checkAllGlobals()` 和 `findLib(name)` 命令
- **添加 crossorigin 属性** - 为所有CDN资源添加 `crossorigin="anonymous"` 属性
- **添加备用CDN源** - 为 `skinview3d` 和 `nbtify` 添加 unpkg 备用加载源
- **添加CDN失败监测** - 监测jsDelivr加载失败并提供错误提示
- **移除有问题的库** - 移除了以下有兼容性问题的库：
  - `canvas-nest.js` - `getComputedStyle` 错误
  - `jquery.ripples` - 依赖jQuery未加载
  - `simplex-noise` - CommonJS模块兼容性问题
  - `cursor-effects` - 加载问题
  - `fluid-js` - 依赖问题
  - `lax.js` / `lenis` / `rellax.js` / `delaunator` - 暂时移除
- **保留核心库** - 保留Vanta.js、Granim.js、Pts.js、Babylon.js等稳定库

### 代码错误修复
- **修复内联 script 标签问题** - 移除了 `innerHTML` 中嵌入的 `<script>` 标签，避兽浏览器报错
- **修复函数定义位置** - 将 `switchThemeTab`、`showPremiumUnlockInfo`、`showMobileKeyModal` 移动到全局作用域
- **修复变量未定义错误** - 移除了 `renderMobileSettings` 中引用未定义变量 `advancedThemeOptions` 的残留代码
- **修复HTML事件属性箭头函数** - 将 `onclick` 中的箭头函数改为普通函数以提高兼容性

---

## 🐛 修复的问题 (v1.17.9 beta版 - 2026年2月9日)

### 布局修复
- **修复 page-header 布局问题** - 添加 `!important` 确保 flex 布局生效，标题和按钮正确排列
- **修复按钮样式** - 添加 `display:inline-flex` 和 `gap:8px` 确保图标和文字有正确间距
- **修复上传卡片间距** - 添加 `margin-top: 24px` 确保与标题区域正确分隔

### CSS 优化
- **增强 .page-header 样式** - 添加 `width: 100%` 和 `box-sizing: border-box`
- **优化按钮容器** - 添加 flex 布局确保按钮正确排列

### JavaScript 错误修复
- **修复 GSAP 动画错误** - 添加元素存在检查，避免在元素未渲染时尝试动画
- **修复 generator panel 错误** - 添加 null 检查，确保元素存在后才设置 innerHTML
- **添加动画刷新方法** - 新增 `GSAPAnimations.refresh()` 方法，在内容渲染后可调用以刷新动画

---

## ⚠️ 浏览器兼容性说明

### 跟踪防护 (Tracking Prevention)
某些浏览器（如Edge、Safari）的跟踪防护功能可能会阻止加载CDN资源，导致以下错误：
```
Tracking Prevention blocked access to storage for https://cdn.jsdelivr.net/...
```

**解决方法：**
1. **Edge浏览器**：点击地址栏左侧的盾牌图标 🔒 → 关闭"跟踪防护"或选择"基本"级别
2. **Safari浏览器**：设置 → 隐私 → 关闭"阻止跨站跟踪"
3. **其他浏览器**：尝试关闭广告拦截插件或浏览器隐私保护功能

### Tailwind CSS 警告
```
cdn.tailwindcss.com should not be used in production
```
这是Tailwind官方的使用建议，不是错误，可以安全忽略。

---

## 📝 待办事项 / 未来更新计划

### 已知问题待修复
- [ ] **指令页分类问题** - 网易分类变成了未知，需要修改
- [ ] **分类丢失问题** - 红石元件、物品ID、准则ID三个页面的分类丢失，需要补充
- [ ] **转换器Bug** - 旧语法输入进去提示"当前使用的是旧语法，需要自己改为新语法"，这是严重的bug
- [ ] **皮肤编辑器问题** - 连初始化都做不到，一直提示网络未连接

### 功能增强计划
- [ ] **移动端专属优化** - 针对手机版的特殊优化
- [ ] **工具箱扩展** - 新增基岩版和网易版能用的工具（现有工具太少）
- [ ] **导航收起功能** - 导航应当可以收起，这样可以更好的布局（手机版和电脑版都要有）

### 更新优先级
1. 🔴 高优先级：转换器Bug修复、分类问题修复
2. 🟡 中优先级：皮肤编辑器修复、工具箱扩展
3. 🟢 低优先级：导航收起功能、移动端专属优化

---

## 📊 文件信息

- **当前版本**: v1.17.9 beta
- **总代码行数**: 约10,227行
- **最后更新**: 2026年2月10日
- **作者**: 轮回道尘
